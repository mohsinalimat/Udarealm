branches:
  only:
  - master
language: objective-c
osx_image: xcode8.1
env:
  matrix:
  - OS='10.1' name='iPhone 6'
  global:
  - APP_NAME="Udarealm"
  - 'DEVELOPER_NAME="iPhone Distribution: Nanjing Viroyal Network Technology Co.,
    Ltd. (N7F69UBB9A)"'
  - PROFILE_NAME="Udarealm_Ad_Hoc"
  - secure=Yw4mET1EdvLuJhboZv16s6MQ/J9/TsN4FnmmZ7EoTE1dn9xiVAE64m2Pd33YKn0ogVUVxtaS3rSZACFA12swojfJwkUhrJr0DtpMQYfhSCG2T84Mv841OVJBSjRbZU179ybVrrlRD8fHnPwIcruSAiURdmLbEZpCPBFShM4lj/PW1lwscRHbWIUegG9DyVGlSu//5I/+b1O6l1PlLr6szQIh7i1Y3JSiqlA5j+e7b7NUuwPQ2+c8VSqprL+JLRt6qYeyFMsmU2c9Ch2s09M84KlRhjaqThxJK18XatkWiQweM05B2rGwxbO5zm2quuPEcQZfBPibonzWd6BhHJAD9uCGC0xk82GBw0ylbYClu0Vx5BXztZ9VWPhjZd0Vxhm3wHU1/yb2m5brimpnUp0RbIPIORtQHDGSOdWZRRKsYheHH87rwVDqwpP6d0ApPtMsNWuTxK7yoQZgftp7gku3Jt3ReDh3UY5ez2bmd/swRAmkAtWzviIeHQM0G96keXSNhDjGUAJzSyDRKWlsNFFbYRS2dNPf14/43cAW+PmIgydfqxjqBSrxOv/Uo+ItQifxebhKR9F7ve5p9w6jPeQSsGpTitIQt8xUqu1MskNBliZHkQW1BT0OGMyfYG+jOLrPZoeu7V0nFb2hJlW5J2EqxDOYSBMmfA6t7IkxqrP6NCs=
before_install:
- brew update
- gem install cocoapods
- gem install fir-cli
before_script:
- openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/profile/$PROFILE_NAME.mobileprovision.enc
  -d -a -out scripts/profile/$PROFILE_NAME.mobileprovision
- openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/certs/dist.cer.enc -d -a
  -out scripts/certs/dist.cer
- openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/certs/dist.p12.enc -d -a
  -out scripts/certs/dist.p12

- ./scripts/add-key.sh

- pod install --verbose --no-repo-update
script:
- xcodebuild -workspace $APP_NAME.xcworkspace -scheme Today    -sdk iphoneos -configuration
  Release ONLY_ACTIVE_ARCH=NO OBJROOT=$PWD/build SYMROOT=$PWD/build CODE_SIGN_IDENTITY="$DEVELOPER_NAME"
- xcodebuild -workspace $APP_NAME.xcworkspace -scheme $APP_NAME -sdk iphoneos -configuration
  Release ONLY_ACTIVE_ARCH=NO OBJROOT=$PWD/build SYMROOT=$PWD/build CODE_SIGN_IDENTITY="$DEVELOPER_NAME"
after_success:
- ./scripts/sign-and-upload.sh
after_script:
- ./scripts/remove-key.sh
